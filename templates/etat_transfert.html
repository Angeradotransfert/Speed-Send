<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Suivi de votre transfert - SpeedSend</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(to right, #4facfe, #00f2fe);
            padding: 40px 20px;
            text-align: center;
        }
        .notification {
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            max-width: 600px;
            margin: 0 auto 20px;
            color: #fff;
        }
        .notification.success { background-color: #22c55e; }
        .notification.pending { background-color: #facc15; color: #333; }
        .flash-message {
            background-color: #d1fae5;
            color: #065f46;
            padding: 12px 20px;
            border-radius: 10px;
            margin: 0 auto 20px;
            font-weight: bold;
            max-width: 600px;
        }
        .card {
            background: #fff;
            color: #333;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            max-width: 600px;
            margin: auto;
        }
        .details p { margin: 6px 0; }
        .progress-bar {
            display: flex;
            margin: 30px 0 10px;
            justify-content: space-between;
        }
        .step {
            flex: 1;
            height: 4px;
            background: #ccc;
            margin: 0 4px;
            position: relative;
        }
        .step.active { background: #22c55e; }
        .step::before {
            content: "";
            width: 12px;
            height: 12px;
            background: #ccc;
            border-radius: 50%;
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
        }
        .step.active::before { background: #22c55e; }
        .labels {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            margin-bottom: 20px;
        }
        .btn-home {
            background: #2563eb;
            color: white;
            padding: 12px 25px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: bold;
            display: inline-block;
            margin-top: 20px;
            transition: 0.3s;
        }
        .btn-home:hover { background: #1d4ed8; }
        img.qr { margin-top: 10px; }
    </style>
</head>
<body>

<!-- ‚úÖ Message flash apr√®s paiement -->
{% with messages = get_flashed_messages() %}
  {% if messages %}
    <div class="flash-message">
      {% for message in messages %}
        {{ message }}
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<!-- ‚úÖ Notification selon le statut -->
{% if transfert.status == 'effectu√©' %}
    <div class="notification success">‚úÖ Votre transfert a √©t√© valid√© avec succ√®s.</div>
{% else %}
    <div class="notification pending">‚è≥ Votre transfert est encore en attente de validation.</div>
{% endif %}

<!-- üì¶ Carte avec tous les d√©tails du transfert -->
<div class="card">
    <h2>üìù D√©tails du transfert</h2>
    <div class="details">
        <p><strong>Exp√©diteur :</strong> {{ transfert.sender_name }}</p>
        <p><strong>Pays d'envoi :</strong> {{ transfert.sender_country }}</p> <!-- ‚úÖ Ajout -->
        <p><strong>Montant :</strong> {{ transfert.amount }} {{ transfert.currency }}</p>
        <p><strong>Total pay√© :</strong> {{ transfert.total_with_fees }} {{ transfert.currency }}</p>
        <p><strong>Destinataire :</strong> {{ transfert.recipient_name }} - {{ transfert.recipient_phone }}</p>
        <p><strong>Pays de r√©ception :</strong> {{ transfert.recipient_country }}</p> <!-- ‚úÖ Ajout -->
        <p><strong>Op√©rateur :</strong> {{ transfert.recipient_operator }}</p>
        <p><strong>Date :</strong> {{ transfert.created_at }}</p>
    </div>

    <!-- ‚è≥ Barre de progression -->
    <div class="progress-bar">
        <div class="step active"></div>
        <div class="step {% if transfert.status == 'effectu√©' %}active{% endif %}"></div>
    </div>
    <div class="labels">
        <span>En attente</span>
        <span>Effectu√©</span>
    </div>

    <!-- üî¢ R√©f√©rence + QR code -->
    <hr>
    <p><strong>R√©f√©rence :</strong> TX-{{ "%05d"|format(transfert.id) }}</p>
    <p>üì≤ Scannez ce QR code pour suivre √† tout moment :</p>
    <img class="qr" src="https://chart.googleapis.com/chart?cht=qr&chs=160x160&chl={{ url_for('etat_transfert', transfert_id=transfert.id, _external=True) }}" alt="QR Code">

    <!-- üè† Retour √† l'accueil -->
    <a href="{{ url_for('home') }}" class="btn-home">üè† Retour √† l'accueil</a>
</div>

</body>
</html>
